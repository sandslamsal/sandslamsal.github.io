<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> PileCapDesign - Rigid Pile Cap Load Distribution | Sandesh Lamsal </title> <meta name="author" content="Sandesh Lamsal"> <meta name="description" content="Rigid pile cap load &amp; moment distribution to piles, reactions, uplift and basic checks."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%85%82&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://sandslamsal.github.io/apps/pilecap/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Sandesh</span> Lamsal </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/tutorial/">tutorial </a> </li> <li class="nav-item active"> <a class="nav-link" href="/apps/">apps <span class="sr-only">(current)</span> </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">PileCapDesign - Rigid Pile Cap Load Distribution</h1> <p class="post-description">Rigid pile cap load &amp; moment distribution to piles, reactions, uplift and basic checks.</p> </header> <article> <div class="post pilecap-app" id="pilecap-app-root"> <a href="/apps/" class="back-button">‚Üê Back to Apps</a> <h1>PileCapDesign (Beta)</h1> <p class="intro">Rigid distribution of axial load P and biaxial moments Mx, My to pile reactions assuming a perfectly rigid cap. Provides reactions, uplift highlighting, basic capacity utilisation and a preliminary punching shear check.</p> <form id="pilecap-form" class="pc-form" novalidate=""> <fieldset class="design-data-section"> <legend>üìã Design Data Input System</legend> <div class="subsection"> <h4>Project Information</h4> <div class="field-group"> <div class="field"> <label for="pc-project-name">Project Name</label><input type="text" id="pc-project-name" value="Pile Cap Design"> </div> <div class="field"> <label for="pc-designer">Designer</label><input type="text" id="pc-designer" value=""> </div> <div class="field"> <label for="pc-date">Date</label><input type="date" id="pc-date"> </div> </div> </div> <div class="subsection"> <h4>üèóÔ∏è Footing Data</h4> <div class="field-group"> <div class="field"> <label for="pc-footing-length">Footing Length (ft)</label><input type="number" id="pc-footing-length" step="0.1" value="20.0"> </div> <div class="field"> <label for="pc-footing-width">Footing Width (ft)</label><input type="number" id="pc-footing-width" step="0.1" value="16.0"> </div> <div class="field"> <label for="pc-footing-thickness">Footing Thickness (ft)</label><input type="number" id="pc-footing-thickness" step="0.1" value="3.0"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-top-elevation">Top of Footing Elevation (ft)</label><input type="number" id="pc-top-elevation" step="0.1" value="100.0"> </div> <div class="field"> <label for="pc-bottom-elevation">Bottom of Footing Elevation (ft)</label><input type="number" id="pc-bottom-elevation" step="0.1" value="97.0"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-concrete-fc">Concrete f'c (psi)</label><input type="number" id="pc-concrete-fc" step="100" value="4000"> </div> <div class="field"> <label for="pc-concrete-density">Concrete Density (pcf)</label><input type="number" id="pc-concrete-density" step="1" value="150"> </div> <div class="field"> <label for="pc-concrete-ec">Concrete Ec (ksi)</label><input type="number" id="pc-concrete-ec" step="100" value="3605"> </div> </div> </div> <div class="subsection"> <h4>üîß Pile Data</h4> <div class="field-group"> <div class="field"> <label for="pc-pile-size">Pile Size (in)</label><input type="number" id="pc-pile-size" step="0.5" value="14"> </div> <div class="field"> <label for="pc-pile-capacity-compression">Pile Capacity - Compression (kips)</label><input type="number" id="pc-pile-capacity-compression" step="10" value="350"> </div> <div class="field"> <label for="pc-pile-capacity-tension">Pile Capacity - Tension (kips)</label><input type="number" id="pc-pile-capacity-tension" step="10" value="100"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-pile-spacing-x">Pile Spacing X-direction (ft)</label><input type="number" id="pc-pile-spacing-x" step="0.5" value="8.0"> </div> <div class="field"> <label for="pc-pile-spacing-y">Pile Spacing Y-direction (ft)</label><input type="number" id="pc-pile-spacing-y" step="0.5" value="8.0"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-pile-no-x">Number of Piles (X-direction)</label><input type="number" id="pc-pile-no-x" min="1" step="1" value="3"> </div> <div class="field"> <label for="pc-pile-no-y">Number of Piles (Y-direction)</label><input type="number" id="pc-pile-no-y" min="1" step="1" value="2"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-pile-top-elevation">Top of Pile Elevation (ft)</label><input type="number" id="pc-pile-top-elevation" step="0.1" value="97.0"> </div> <div class="field"> <label for="pc-pile-tip-elevation">Tip of Pile Elevation (ft)</label><input type="number" id="pc-pile-tip-elevation" step="0.1" value="47.0"> </div> </div> </div> <div class="subsection"> <h4>üèõÔ∏è Column Data</h4> <div class="field-group"> <div class="field"> <label for="pc-column-x-dim">Column X-dimension (ft)</label><input type="number" id="pc-column-x-dim" step="0.1" value="2.0"> </div> <div class="field"> <label for="pc-column-y-dim">Column Y-dimension (ft)</label><input type="number" id="pc-column-y-dim" step="0.1" value="2.0"> </div> <div class="field"> <label for="pc-column-base-elevation">Column Base Elevation (ft)</label><input type="number" id="pc-column-base-elevation" step="0.1" value="100.0"> </div> </div> </div> <div class="subsection"> <h4>üèóÔ∏è Additional Design Parameters</h4> <div class="field-group"> <div class="field"> <label for="pc-pile-overhang">Pile Overhang (in)</label><input type="number" id="pc-pile-overhang" step="0.5" value="6.0"> </div> <div class="field"> <label for="pc-pile-embedment">Pile Embedment in Footing (in)</label><input type="number" id="pc-pile-embedment" step="0.5" value="6.0"> </div> <div class="field"> <label for="pc-seal-thickness">Seal Thickness (ft)</label><input type="number" id="pc-seal-thickness" step="0.1" value="0.5"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-reinforcing-cover">Reinforcing Cover (in)</label><input type="number" id="pc-reinforcing-cover" step="0.25" value="3.0"> </div> <div class="field"> <label for="pc-reinforcing-steel-fy">Reinforcing Steel fy (ksi)</label><input type="number" id="pc-reinforcing-steel-fy" step="1" value="60"> </div> <div class="field"> <label for="pc-concrete-fc-ksi">Concrete f'c (ksi)</label><input type="number" id="pc-concrete-fc-ksi" step="0.1" value="4.0"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-soil-weight">Soil Weight (ksf)</label><input type="number" id="pc-soil-weight" step="0.01" value="0.12"> </div> <div class="field"> <label for="pc-ground-elevation">Ground Elevation (ft)</label><input type="number" id="pc-ground-elevation" step="0.1" value="105.0"> </div> <div class="field"> <label for="pc-water-elevation">Water Elevation (ft)</label><input type="number" id="pc-water-elevation" step="0.1" value="95.0"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-column-ecc-x">Column Eccentricity X (ft)</label><input type="number" id="pc-column-ecc-x" step="0.1" value="0.0"> </div> <div class="field"> <label for="pc-column-ecc-y">Column Eccentricity Y (ft)</label><input type="number" id="pc-column-ecc-y" step="0.1" value="0.0"> </div> </div> </div> <div class="action-row"> <button type="button" id="pc-generate-coords" class="calc-button">üéØ Generate Pile Coordinates</button> <button type="button" id="pc-validate-layout" class="calc-button secondary">‚úÖ Validate Layout</button> </div> <div id="pc-coordinates-display" class="coordinates-display" hidden=""> <h4>üìç Generated Pile Coordinates</h4> <div id="pc-coordinates-table"></div> <div id="pc-layout-validation" class="validation-results"></div> </div> </fieldset> <fieldset> <legend>üìä Load Input Configuration</legend> <div class="load-case-selection"> <h4>Load Case Selection</h4> <div class="field-group"> <label class="radio-option"> <input type="radio" name="load-case-type" id="pc-single-load" value="single" checked> <span>Single Load Case</span> </label> <label class="radio-option"> <input type="radio" name="load-case-type" id="pc-multiple-loads" value="multiple"> <span>Multiple Load Cases</span> </label> </div> </div> <div id="single-load-section" class="load-section"> <h4>Single Load Case Input</h4> <div class="field"> <label for="pc-load-p">Axial Load P (kips)</label><input type="number" id="pc-load-p" step="0.01" required="" value="5000"> </div> <div class="field-group"> <div class="field"> <label for="pc-mx">Mx (kip-ft) (+ causes compression at ‚àíy)</label><input type="number" id="pc-mx" step="0.01" value="0"> </div> <div class="field"> <label for="pc-my">My (kip-ft) (+ causes compression at +x)</label><input type="number" id="pc-my" step="0.01" value="0"> </div> </div> </div> <div id="multiple-load-section" class="load-section" hidden=""> <h4>Multiple Load Cases Input</h4> <p class="help"> Paste data from Excel/CSV with columns: Load Case, Factor, Fx (k), Fy (k), Fz (k), Mx (k-ft), My (k-ft)<br> <strong>Example format:</strong><br> <code>1 1.00 230 233 6764 10600 12710</code><br> <code>2 1.00 -230 233 4876 10590 10160</code> </p> <textarea id="pc-multiple-load-data" rows="10" placeholder="Load Case Factor Fx (k) Fy (k) Fz (k) Mx (k-ft) My (k-ft) 1 1.00 230 233 6764 10600 12710 2 1.00 -230 233 4876 10590 10160 3 1.00 0 143 8113 6958 1782"></textarea> <div class="action-row"> <button type="button" id="pc-parse-loads" class="calc-button secondary">üìã Parse Load Data</button> <button type="button" id="pc-clear-loads" class="calc-button secondary">üóëÔ∏è Clear Data</button> </div> <div id="pc-parsed-loads-display" class="parsed-loads-display" hidden=""> <h5>Parsed Load Cases</h5> <div id="pc-parsed-loads-table"></div> </div> </div> </fieldset> <fieldset> <legend>Multi Load Cases (Optional)</legend> <p class="help">Enter load cases (overrides single load inputs when not empty). One per line:<br><code>Name P(kN) Mx(kN¬∑m) My(kN¬∑m)</code> (space or comma separated)<br>Example:<br><code>LC1 5000 200 150</code><br><code>LC2 6200 -150 300</code></p> <textarea id="pc-loadcases" rows="4" placeholder="LC1 5000 200 150\nLC2 6200 -150 300"></textarea> <label class="inline"><input type="checkbox" id="pc-allow-tension-cases"> Allow tension (do not zero negatives)</label> </fieldset> <fieldset> <legend>Pile Layout</legend> <p class="help">Enter pile coordinates (m). One pile per line as: x,y (comma / space separated). Example rectangle shown.</p> <textarea id="pc-coords" rows="6" placeholder="0,0 3,0 3,2 0,2">0,0
3,0
3,2
0,2</textarea> </fieldset> <fieldset> <legend>Cap &amp; Pile Properties</legend> <div class="field-group"> <div class="field"> <label for="pc-allow-comp">Allowable Compression (kN)</label><input type="number" id="pc-allow-comp" value="1500" step="1"> </div> <div class="field"> <label for="pc-allow-ten">Allowable Tension (kN) (&gt;=0)</label><input type="number" id="pc-allow-ten" value="0" step="1"> </div> <div class="field"> <label for="pc-fc">Concrete f'c (MPa)</label><input type="number" id="pc-fc" value="35" step="1"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-diameter">Pile Diameter d_p (m)</label><input type="number" id="pc-diameter" value="0.4" step="0.01"> </div> <div class="field"> <label for="pc-cap-thk">Cap Thickness t_c (m)</label><input type="number" id="pc-cap-thk" value="0.9" step="0.01"> </div> </div> </fieldset> <fieldset> <legend>Member Demands &amp; Strips</legend> <div class="field-group"> <div class="field"> <label for="pc-fy">Steel fy (MPa)</label><input type="number" id="pc-fy" value="420" step="1"> </div> <div class="field"> <label for="pc-phi-flex">œï (Flexure)</label><input type="number" id="pc-phi-flex" value="0.90" step="0.01"> </div> <div class="field"> <label for="pc-phi-shear">œï (Shear)</label><input type="number" id="pc-phi-shear" value="0.75" step="0.01"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-bx">Strip width b<sub>x</sub> (m)</label><input type="number" id="pc-bx" value="1.0" step="0.01"> </div> <div class="field"> <label for="pc-by">Strip width b<sub>y</sub> (m)</label><input type="number" id="pc-by" value="1.0" step="0.01"> </div> <div class="field"> <label for="pc-deff">Effective depth d (m)</label><input type="number" id="pc-deff" value="0.72" step="0.01"> </div> </div> <div class="field-group"> <div class="field"> <label for="pc-mux">Mu<sub>x</sub> (kN¬∑m)</label><input type="number" id="pc-mux" value="800" step="1"> </div> <div class="field"> <label for="pc-muy">Mu<sub>y</sub> (kN¬∑m)</label><input type="number" id="pc-muy" value="650" step="1"> </div> <div class="field"> <label for="pc-vux">Vu<sub>x</sub> (kN)</label><input type="number" id="pc-vux" value="250" step="1"> </div> <div class="field"> <label for="pc-vuy">Vu<sub>y</sub> (kN)</label><input type="number" id="pc-vuy" value="220" step="1"> </div> </div> </fieldset> <fieldset> <legend>Column &amp; Reinforcement (Multi-Case Auto)</legend> <div class="field-group"> <div class="field"> <label for="pc-colx">Column Dim X (m)</label><input type="number" id="pc-colx" value="1.0" step="0.01"> </div> <div class="field"> <label for="pc-coly">Column Dim Y (m)</label><input type="number" id="pc-coly" value="1.0" step="0.01"> </div> <div class="field"> <label for="pc-bar-dia">Bar √ò (mm)</label><input type="number" id="pc-bar-dia" value="32" step="1"> </div> <div class="field"> <label for="pc-bar-spacing">Bar Spacing (mm)</label><input type="number" id="pc-bar-spacing" value="150" step="5"> </div> </div> <p class="help">Used to auto-compute Mu &amp; Vu per load case from reactions (AASHTO-style simplified). Single-load manual Mu/Vu inputs still honored.</p> </fieldset> <div class="action-row"> <button type="button" id="pc-analyze" class="calc-button">Analyze</button> <button type="button" id="pc-example" class="calc-button secondary">Load Example</button> <button type="reset" class="calc-button secondary" id="pc-reset">Reset</button> </div> </form> <div id="pc-status" class="pc-status" role="status" aria-live="polite"></div> <div id="pc-results" class="pc-results" hidden=""> <h2>Results</h2> <div class="pc-summary" id="pc-summary"></div> <div class="pc-mc-wrapper" id="pc-mc-wrapper" hidden=""> <h2>Multi Load Case Summary</h2> <table class="pc-table" id="pc-lc-table"> <thead><tr> <th>Case</th> <th>P (kN)</th> <th>Mx</th> <th>My</th> <th>Pmax</th> <th>Pmin</th> <th>Punch Util</th> <th>Uplift?</th> </tr></thead> <tbody></tbody> </table> <h3>Per-Pile Governing Reactions</h3> <table class="pc-table" id="pc-pile-extremes"> <thead><tr> <th>Pile</th> <th>x (m)</th> <th>y (m)</th> <th>Max (kN)</th> <th>Case</th> <th>Min (kN)</th> <th>Case</th> </tr></thead> <tbody></tbody> </table> <h3>Multi-Case Strength (Auto Mu/Vu)</h3> <table class="pc-table" id="pc-strength-cases"> <thead><tr> <th>Case</th> <th>Mu_x (kN¬∑m)</th> <th>Mu_y</th> <th>Vu_x (kN)</th> <th>Vu_y</th> <th>Flex Util X</th> <th>Flex Util Y</th> <th>OWS Util X</th> <th>OWS Util Y</th> </tr></thead> <tbody></tbody> </table> <h3>Governing Checks</h3> <table class="pc-table" id="pc-governing"> <thead><tr> <th>Check</th> <th>Governing Case</th> <th>Utilisation</th> </tr></thead> <tbody></tbody> </table> </div> <div class="pc-table-wrapper"> <table class="pc-table" id="pc-table" aria-describedby="pc-summary"> <thead><tr> <th>#</th> <th>x (m)</th> <th>y (m)</th> <th>Reaction (kN)</th> <th>Utilisation</th> <th>Status</th> </tr></thead> <tbody></tbody> </table> </div> <div class="pc-plot-wrapper"> <canvas id="pc-plan" width="600" height="400" aria-label="Pile reaction plan view"></canvas> </div> <div class="pc-punch" id="pc-punch"></div> <div class="pc-flexure" id="pc-flexure"></div> <div class="pc-ows" id="pc-ows"></div> </div> <section class="pc-notes"> <h3>Method Notes</h3> <ul> <li>Assumes rigid cap: reaction distribution via linear surface R(x,y)=a+b x'+c y'.</li> <li>Centroid subtraction ensures Œ£x'=Œ£y'=0 so a=P/n.</li> <li>Moments give 2√ó2 system for b &amp; c including coupling term Œ£x'y'.</li> <li>Uplift reported where reaction &lt; 0 (tension). Tension capacity check uses allowable tension input.</li> <li>Punching shear check: preliminary per-pile check using the most compressed pile with V<sub>u</sub> = P<sub>max</sub>, critical perimeter at d/2 around pile (b<sub>0</sub> = œÄ(d<sub>p</sub> + d)), nominal V<sub>c</sub> = 0.33‚àöf'c¬∑b<sub>0</sub>¬∑d (SI formulation, converted to kN), and œï = 0.75.</li> <li>Flexure module assumes singly-reinforced rectangular strip; œïM<sub>n</sub> computed from equilibrium with a=As¬∑fy/(0.85f'c¬∑b). ACI/AASHTO-style Œ≤<sub>1</sub> approximation is used.</li> <li>One-way shear uses an ACI-like V<sub>c</sub>=0.17¬∑Œª¬∑‚àöf'c¬∑b¬∑d in SI (converted to kN). Adjust œï as needed.</li> <li>Beta version: does not include differential stiffness or lateral load effects.</li> </ul> </section> </div> <script src="/assets/js/pilecap-core.js"></script> <script>!function(){function t(t){const e=parseFloat(t.value);return isNaN(e)?0:e}function e(t,e=2){return Number.isFinite(t)?t.toFixed(e):"-"}function n(t){return t.split(/\n+/).map(t=>t.trim()).filter(Boolean).map(t=>{const e=t.split(/[\s,]+/).map(Number).filter(t=>!isNaN(t));if(e.length<2)throw new Error(`Invalid line: "${t}"`);return{x:e[0],y:e[1]}})}function a(t){const e=t.split(/\n+/).map(t=>t.trim()).filter(t=>t.length),n=[];for(const t of e){const e=t.split(/[\s,]+/).filter(Boolean);if(e.length<4)throw new Error(`Line needs name P Mx My: ${t}`);const[a,o,i,s]=e,c=parseFloat(o),r=parseFloat(i),d=parseFloat(s);if([c,r,d].some(t=>isNaN(t)))throw new Error(`Non-numeric in: ${t}`);n.push({name:a,P:c,Mx:r,My:d})}return n}function o(t){return t.length?t.reduce((t,e)=>t+e,0)/t.length:0}function i(t,e="info"){const n=Z("#pc-status");n.textContent=t,n.classList.remove("error","success"),"error"===e&&n.classList.add("error"),"success"===e&&n.classList.add("success")}function s(t,e,n,a){const o=[];let i=1;const s=-((t-1)*e)/2,c=-((n-1)*a)/2;for(let r=0;r<n;r++)for(let n=0;n<t;n++){const t=s+n*e,d=c+r*a;o.push({no:i,x:t,y:d}),i++}return o}function c(t){if(!t||0===t.length)return null;const e=t.length,n=t.reduce((t,e)=>t+e.x,0),a=t.reduce((t,e)=>t+e.y,0),o=n/e,i=a/e,s=t.reduce((t,e)=>t+Math.pow(e.y-i,2),0),c=t.reduce((t,e)=>t+Math.pow(e.x-o,2),0);return{centroidX:o,centroidY:i,totalPiles:e,momentOfInertiaX:s,momentOfInertiaY:c}}function r(t,e,n,a,o,i){const s=[],c=[],r=3;n<r&&s.push(`X-direction pile spacing (${n} ft) may be too small. Consider minimum ${r} ft.`),a<r&&s.push(`Y-direction pile spacing (${a} ft) may be too small. Consider minimum ${r} ft.`);const d=(t-1)*n,l=(e-1)*a;d<1.5*o&&s.push(`Pile group width (${d.toFixed(1)} ft) may be small relative to column width (${o} ft).`),l<1.5*i&&s.push(`Pile group height (${l.toFixed(1)} ft) may be small relative to column height (${i} ft).`);const p=t*e;return p<4&&s.push(`Total number of piles (${p}) is very low. Consider increasing for stability.`),{warnings:s,errors:c,pileGroupWidth:d,pileGroupHeight:l,totalPiles:p}}function d(){const t=(new Date).toISOString().split("T")[0];Z("#pc-date").value=t,Z("#pc-generate-coords").addEventListener("click",f),Z("#pc-validate-layout").addEventListener("click",x),["#pc-pile-no-x","#pc-pile-no-y","#pc-pile-spacing-x","#pc-pile-spacing-y"].forEach(t=>{Z(t).addEventListener("input",v)}),l()}function l(){function t(){e.checked?(a.hidden=!1,o.hidden=!0):(a.hidden=!0,o.hidden=!1)}const e=Z("#pc-single-load"),n=Z("#pc-multiple-loads"),a=Z("#single-load-section"),o=Z("#multiple-load-section");e.addEventListener("change",t),n.addEventListener("change",t),Z("#pc-parse-loads").addEventListener("click",p),Z("#pc-clear-loads").addEventListener("click",m),t()}function p(){try{const t=Z("#pc-multiple-load-data").value.trim();if(!t)return void i("Please enter load case data to parse.","error");const e=u(t);h(e),i(`Successfully parsed ${e.length} load cases.`,"success")}catch(t){i(`Error parsing load cases: ${t.message}`,"error")}}function u(t){const e=t.split("\n").map(t=>t.trim()).filter(t=>t.length>0),n=[];for(let t=0;t<e.length;t++){const a=e[t];if(a.toLowerCase().includes("load case")||a.toLowerCase().includes("factor"))continue;const o=a.split(/[\t\s,]+/).filter(t=>t.length>0);if(o.length<7)throw new Error(`Line ${t+1}: Expected 7 columns (Load Case, Factor, Fx, Fy, Fz, Mx, My), got ${o.length}`);const[i,s,c,r,d,l,p]=o.map((e,n)=>{if(0===n)return e;const a=parseFloat(e);if(isNaN(a))throw new Error(`Line ${t+1}: Invalid number "${e}" in column ${n+1}`);return a});n.push({caseId:i,factor:s,forces:{fx:c,fy:r,fz:d},moments:{mx:l,my:p},P:d*s,Mx:l*s,My:p*s})}return n}function h(t){const e=Z("#pc-parsed-loads-display"),n=Z("#pc-parsed-loads-table");let a='<table class="load-cases-table">\n      <thead>\n        <tr>\n          <th>Case</th>\n          <th>Factor</th>\n          <th>Fx (k)</th>\n          <th>Fy (k)</th>\n          <th>Fz (k)</th>\n          <th>Mx (k-ft)</th>\n          <th>My (k-ft)</th>\n        </tr>\n      </thead>\n      <tbody>';t.forEach(t=>{a+=`<tr>\n        <td>${t.caseId}</td>\n        <td>${t.factor.toFixed(2)}</td>\n        <td>${t.forces.fx.toFixed(1)}</td>\n        <td>${t.forces.fy.toFixed(1)}</td>\n        <td>${t.forces.fz.toFixed(1)}</td>\n        <td>${t.moments.mx.toFixed(1)}</td>\n        <td>${t.moments.my.toFixed(1)}</td>\n      </tr>`}),a+="</tbody></table>",n.innerHTML=a,e.hidden=!1,window.parsedLoadCases=t}function m(){Z("#pc-multiple-load-data").value="",Z("#pc-parsed-loads-display").hidden=!0,window.parsedLoadCases=null,i("Load case data cleared.","info")}function f(){try{const t=parseInt(Z("#pc-pile-no-x").value)||3,e=parseInt(Z("#pc-pile-no-y").value)||2,n=parseFloat(Z("#pc-pile-spacing-x").value)||8,a=s(t,n,e,parseFloat(Z("#pc-pile-spacing-y").value)||8);g(a,c(a));const o=a.map(t=>`${(.3048*t.x).toFixed(3)},${(.3048*t.y).toFixed(3)}`).join("\n");Z("#pc-coords").value=o,Z("#pc-coordinates-display").hidden=!1,i(`Generated ${a.length} pile coordinates successfully.`,"success")}catch(t){i(`Error generating coordinates: ${t.message}`,"error")}}function x(){try{const t=parseInt(Z("#pc-pile-no-x").value)||3,e=parseInt(Z("#pc-pile-no-y").value)||2,n=parseFloat(Z("#pc-pile-spacing-x").value)||8,a=parseFloat(Z("#pc-pile-spacing-y").value)||8,o=parseFloat(Z("#pc-column-x-dim").value)||2,i=parseFloat(Z("#pc-column-y-dim").value)||2;y(r(t,e,n,a,o,i)),Z("#pc-coordinates-display").hidden=!1}catch(t){i(`Error validating layout: ${t.message}`,"error")}}function g(t,e){const n=Z("#pc-coordinates-table");let a='<div class="coordinates-summary"><h5>Pile Group Summary</h5><div class="summary-grid">';a+=`<div>Total Piles: <strong>${e.totalPiles}</strong></div>`,a+=`<div>Centroid X: <strong>${e.centroidX.toFixed(3)} ft</strong></div>`,a+=`<div>Centroid Y: <strong>${e.centroidY.toFixed(3)} ft</strong></div>`,a+='</div></div><table class="pile-coordinates-table"><thead><tr><th>Pile No.</th><th>X (ft)</th><th>Y (ft)</th><th>X (m)</th><th>Y (m)</th></tr></thead><tbody>',t.forEach(t=>{const e=.3048*t.x,n=.3048*t.y;a+=`<tr><td>${t.no}</td><td>${t.x.toFixed(2)}</td><td>${t.y.toFixed(2)}</td><td>${e.toFixed(3)}</td><td>${n.toFixed(3)}</td></tr>`}),a+="</tbody></table>",n.innerHTML=a}function y(t){const e=Z("#pc-layout-validation");let n='<div class="validation-summary"><h5>Layout Validation</h5>';n+=`<div>Pile Group Width: <strong>${t.pileGroupWidth.toFixed(1)} ft</strong></div>`,n+=`<div>Total Piles: <strong>${t.totalPiles}</strong></div></div>`,t.warnings.length>0?(n+='<div class="validation-warnings"><h6>\u26a0\ufe0f Warnings:</h6><ul>',t.warnings.forEach(t=>n+=`<li>${t}</li>`),n+="</ul></div>"):n+='<div class="validation-success"><h6>\u2705 Layout validation passed with no issues.</h6></div>',e.innerHTML=n}function v(){const t=parseInt(Z("#pc-pile-no-x").value)||3,e=parseInt(Z("#pc-pile-no-y").value)||2,n=(t-1)*(parseFloat(Z("#pc-pile-spacing-x").value)||8),a=(e-1)*(parseFloat(Z("#pc-pile-spacing-y").value)||8),o=(parseFloat(Z("#pc-pile-size").value)||14)/12,i=Math.max(2,2*o),s=n+2*i,c=a+2*i,r=parseFloat(Z("#pc-footing-length").value),d=parseFloat(Z("#pc-footing-width").value);r<s&&(Z("#pc-footing-length").value=s.toFixed(1)),d<c&&(Z("#pc-footing-width").value=c.toFixed(1))}function M(){const t=parseFloat(Z("#pc-footing-length").value)||20,e=parseFloat(Z("#pc-footing-width").value)||16,n=parseFloat(Z("#pc-footing-thickness").value)||3,a=parseFloat(Z("#pc-seal-thickness").value)||.5,o=parseFloat(Z("#pc-concrete-density").value)||150,i=parseFloat(Z("#pc-soil-weight").value)||.12,s=parseFloat(Z("#pc-ground-elevation").value)||105,c=parseFloat(Z("#pc-top-elevation").value)||100,r=parseFloat(Z("#pc-water-elevation").value)||95,d=t*e,l=d*n,p=d*a,u=l*o/1e3,h=p*o/1e3,m=d*Math.max(0,s-c)*i,f=d*Math.max(0,r-(c-n))*.0624;return{footingWeight:u,sealWeight:h,soilWeight:m,buoyancyForce:f,totalWeight:u+h+m-f,footingArea:d,footingVolume:l,sealVolume:p}}function b(t,e){const{footingLength:n,footingWidth:a,footingThickness:o}=e,i=parseFloat(Z("#pc-reinforcing-cover").value)||3,s=parseFloat(Z("#pc-concrete-fc-ksi").value)||4,c=parseFloat(Z("#pc-column-x-dim").value)||2,r=parseFloat(Z("#pc-column-y-dim").value)||2,d=12*o-i,l=c/2+d/12,p=r/2+d/12;let u=0,h=0;t.forEach(t=>{Math.abs(t.x)>l&&(u+=t.R),Math.abs(t.y)>p&&(h+=t.R)});const m=1,f=.75,x=f*(2*m*Math.sqrt(1e3*s)*a*12*d/1e3),g=f*(2*m*Math.sqrt(1e3*s)*n*12*d/1e3);return{vuX:Math.abs(u),vuY:Math.abs(h),phiVcX:x,phiVcY:g,utilizationX:Math.abs(u)/x,utilizationY:Math.abs(h)/g,passX:Math.abs(u)<=x,passY:Math.abs(h)<=g}}function F(t,e){const{footingThickness:n}=e,a=parseFloat(Z("#pc-reinforcing-cover").value)||3,o=parseFloat(Z("#pc-concrete-fc-ksi").value)||4,i=parseFloat(Z("#pc-column-x-dim").value)||2,s=parseFloat(Z("#pc-column-y-dim").value)||2,c=12*n-a,r=2*(12*i+c+(12*s+c)),d=t.reduce((t,e)=>t+e.R,0),l=1,p=40,u=(2+4/(i/s))*l*Math.sqrt(1e3*o)*r*c/1e3,h=(p*c/r+2)*l*Math.sqrt(1e3*o)*r*c/1e3,m=4*l*Math.sqrt(1e3*o)*r*c/1e3,f=.75*Math.min(u,h,m);return{vu:d,phiVc:f,utilization:d/f,pass:d<=f,bo:r/12,d:c/12}}function $(t,e){const n=parseFloat(Z("#pc-column-x-dim").value)||2,a=parseFloat(Z("#pc-column-y-dim").value)||2,o=parseFloat(Z("#pc-reinforcing-cover").value)||3,i=e.footingThickness,s=parseFloat(Z("#pc-reinforcing-steel-fy").value)||60,c=parseFloat(Z("#pc-concrete-fc-ksi").value)||4,r=12*i-o,d=n/2,l=a/2;let p=0,u=0;t.forEach(t=>{const e=Math.abs(t.y)-l,n=Math.abs(t.x)-d;e>0&&(p+=t.R*e),n>0&&(u+=t.R*n)});const h=12,m=.9,f=12*u,x=k(12*p,h,r,c,s,m),g=k(f,h,r,c,s,m),y=.0018*h*i*12;return{muX:p,muY:u,asReqX:Math.max(x,y),asReqY:Math.max(g,y),asMin:y,d:r/12}}function k(t,e,n,a,o,i){let s=.5,c=0;const r=20;for(;c<r;){const r=i*(s*o*(n-s*o/(.85*a*e)/2));if(r>=t)return s;const d=(t-r)/(i*o*n);s+=Math.max(.01,d),c++}return s}function _(t){const e={footingLength:parseFloat(Z("#pc-footing-length").value)||20,footingWidth:parseFloat(Z("#pc-footing-width").value)||16,footingThickness:parseFloat(Z("#pc-footing-thickness").value)||3},n=M(),a=[];return t.forEach(t=>{const o=t.sol.reactions,i=b(o,e),s=F(o,e),c=$(o,e);a.push({loadCase:t.lc,weights:n,oneWayShear:i,punchingShear:s,flexuralMoments:c,overallPass:i.passX&&i.passY&&s.pass})}),{results:a,weights:n,footingGeometry:e}}function P({P:t,Mx:e,My:n,coords:a,activeMask:i=null}){const s=a.map((t,e)=>({...t,active:!i||i[e]})),c=s.filter(t=>t.active);if(!c.length)throw new Error("No active piles");const r=o(c.map(t=>t.x)),d=o(c.map(t=>t.y)),l=s.map(t=>({x:t.x-r,y:t.y-d,active:t.active})),p=c.length;let u=0,h=0,m=0;l.forEach(t=>{t.active&&(u+=t.x*t.x,h+=t.y*t.y,m+=t.x*t.y)});const f=t/p,x=u*h-m*m,g=1e-12;let y=0,v=0;Math.abs(x)>g?(y=(h*n-m*e)/x,v=(-m*n+u*e)/x):(y=u?n/u:0,v=h?e/h:0);const M=a.map((t,e)=>{if(i&&!s[e].active)return{index:e+1,x:t.x,y:t.y,R:0,inactive:!0};const n=l[e],a=f+y*n.x+v*n.y;return{index:e+1,x:t.x,y:t.y,R:a}}),b=Math.max(...M.map(t=>t.R)),F=Math.min(...M.map(t=>t.R));return{reactions:M,Pmax:b,Pmin:F,cx:r,cy:d,a:f,b:y,c:v,Sxx:u,Syy:h,Sxy:m}}function w({P:t,Mx:e,My:n,coords:a,maxLoops:o=20}){let i=new Array(a.length).fill(!0),s=-1,c=null;for(let r=0;r<o;r++){c=P({P:t,Mx:e,My:n,coords:a,activeMask:i});const o=c.reactions.map((t,e)=>({r:t,i:e})).filter(t=>t.r.R<0&&i[t.i]);if(!o.length)break;if(o.length===s)break;o.forEach(t=>i[t.i]=!1),s=o.length}const r=c.reactions.filter(t=>t.R>0),d=r.reduce((t,e)=>t+e.R,0);if(d>0){const e=t/d;r.forEach(t=>t.R*=e)}return c.Pmax=Math.max(...c.reactions.map(t=>t.R)),c.Pmin=Math.min(...c.reactions.map(t=>t.R)),c.iterative=!0,c}function L(t,e,n){if(t>=0)return e>0?t/e:1/0;const a=Math.abs(t);return n>0?a/n:1/0}function S({fcMPa:t,pileDia_m:e,capThk_m:n},a){const o=.8*n,i=Math.PI*(e+o),s=1e3*i,c=1e3*o,r=.33*Math.sqrt(t)*s*c/1e3,d=.75,l=d*r,p=Math.max(0,a),u=l>0?p/l:1/0;return{d_m:o,b0_m:i,Vc_kN:r,phi:d,phiVc_kN:l,Vu_kN:p,utilisation:u,OK:u<=1}}function N({Mu_kNm:t,b_m:e,d_m:n,fc_MPa:a,fy_MPa:o,phi:i}){const s=1e6*t,c=1e3*e,r=1e3*n;let d=1e3;for(let t=0;t<200;t++){const t=r-d*o/(.85*a*c)/2,e=i*(d*o*t);if(e>=s)break;const n=(s-e)/(o*Math.max(t,1));d+=Math.max(10,n)}const l=.0018*c*(n/.8*1e3),p=Math.max(d,l),u=p*o/(.85*a*c),h=r-u/2;return{As_req_mm2:p,As_min_mm2:l,phiMn_kNm:i*(p*o*h)/1e6,a_mm:u,jd_mm:h}}function R({Vu_kN:t,b_m:e,d_m:n,fc_MPa:a,phi:o,lambda_c:i=1}){const s=1e3*e,c=1e3*n,r=.17*i*Math.sqrt(a)*s*c/1e3,d=o*r,l=d>0?t/d:1/0;return{Vu_kN:t,Vc_kN:r,phiVc_kN:d,util:l,OK:l<=1}}function C(t,e,n,a){let o=0,i=0;for(const a of t){const t=Math.abs(a.x),s=Math.abs(a.y);s>n/2&&(o+=a.R*(s-n/2)),t>e/2&&(i+=a.R*(t-e/2))}const s=e/2+a,c=-s,r=n/2+a,d=-r;let l=0,p=0,u=0,h=0;for(const e of t)e.x>s&&(u+=e.R),e.x<c&&(h+=e.R),e.y>r&&(l+=e.R),e.y<d&&(p+=e.R);return{Mu_x:o,Mu_y:i,Vu_x:Math.max(l,p,0),Vu_y:Math.max(u,h,0)}}function V(t,e,n,a,o,i,s){const c=Z("#pc-allow-tension-cases").checked,r=Z("#pc-iter-tension")?.checked,d=[];for(const n of t){let t;if(r)t=w({P:n.P,Mx:n.Mx,My:n.My,coords:e});else if(t=P({P:n.P,Mx:n.Mx,My:n.My,coords:e}),!c){const e=t.reactions.filter(t=>t.R<0);if(e.length){let a=t.reactions.filter(t=>t.R>=0);const o=a.reduce((t,e)=>t+e.R,0),i=o>0?n.P/o:1;for(const t of a)t.R*=i;for(const t of e)t.R=0;t.Pmax=Math.max(...t.reactions.map(t=>t.R)),t.Pmin=Math.min(...t.reactions.map(t=>t.R))}}const a=S({fcMPa:o,pileDia_m:i,capThk_m:s},t.Pmax);d.push({lc:n,sol:t,punch:a})}return d}function E(e){const n=t(Z("#pc-colx"))||1,a=t(Z("#pc-coly"))||1,o=t(Z("#pc-deff"))||.8*t(Z("#pc-cap-thk")),i=t(Z("#pc-fc")),s=t(Z("#pc-fy")),c=t(Z("#pc-phi-flex"))||.9,r=t(Z("#pc-phi-shear"))||.75,d=t(Z("#pc-bx")),l=t(Z("#pc-by"));let p=0,u=0,h=0,m=0;for(const t of e){const e=C(t.sol.reactions,n,a,o);t.demands=e,p=Math.max(p,e.Mu_x),u=Math.max(u,e.Mu_y),h=Math.max(h,e.Vu_x),m=Math.max(m,e.Vu_y)}const f=N({Mu_kNm:p,b_m:d,d_m:o,fc_MPa:i,fy_MPa:s,phi:c}),x=N({Mu_kNm:u,b_m:l,d_m:o,fc_MPa:i,fy_MPa:s,phi:c}),g=R({Vu_kN:h,b_m:d,d_m:o,fc_MPa:i,phi:r}),y=R({Vu_kN:m,b_m:l,d_m:o,fc_MPa:i,phi:r});for(const t of e){const e=t.demands;t.flexUtilX=e.Mu_x/(f.phiMn_kNm||1e-9),t.flexUtilY=e.Mu_y/(x.phiMn_kNm||1e-9),t.owsUtilX=e.Vu_x/(g.phiVc_kN||1e-9),t.owsUtilY=e.Vu_y/(y.phiVc_kN||1e-9)}return{solutions:e,fx:f,fyres:x,owsX:g,owsY:y}}function W({reactions:t},n,a){const o=Z("#pc-table tbody");o.innerHTML="";for(const i of t){const t=L(i.R,n,a),s=i.R<0?a>0?t<=1?"OK (tension)":"NG (tension)":"Uplift":t<=1?"OK":"NG",c=document.createElement("tr");i.R<0&&c.classList.add("uplift"),c.innerHTML=`<td>${i.index}</td><td>${i.x.toFixed(3)}</td><td>${i.y.toFixed(3)}</td><td>${i.R.toFixed(2)}</td><td>${e(t,2)}</td><td>${s}</td>`,o.appendChild(c)}}function Y(t,n,a){const{Pmax:o,Pmin:i}=t,s=L(o,n,a),c=L(i,n,a);Z("#pc-summary").innerHTML=`<p><strong>Pmax:</strong> ${o.toFixed(2)} kN (util ${e(s,2)}) &nbsp; <strong>Pmin:</strong> ${i.toFixed(2)} kN (util ${e(c,2)})</p>`}function T(t){function e(t){if(t<0)return"#e74c3c";const e=(t-g)/(y-g||1);return`rgb(${Math.round(255*e)},80,${Math.round(255*(1-e))})`}const n=Z("#pc-plan"),a=n.getContext("2d"),o=n.width,i=n.height;a.clearRect(0,0,o,i);const s=t.reactions.map(t=>t.x),c=t.reactions.map(t=>t.y),r=Math.min(...s),d=Math.max(...s),l=Math.min(...c),p=Math.max(...c),u=40,h=(o-2*u)/(d-r||1),m=(i-2*u)/(p-l||1),f=(t,e)=>({X:u+(t-r)*h,Y:i-(u+(e-l)*m)});a.lineWidth=1,a.strokeStyle="#ccc",a.strokeRect(u,u,o-2*u,i-2*u);const x=t.reactions.map(t=>t.R),g=Math.min(...x),y=Math.max(...x);for(const n of t.reactions){const{X:t,Y:o}=f(n.x,n.y);a.beginPath(),a.arc(t,o,6,0,2*Math.PI),a.fillStyle=e(n.R),a.fill(),a.strokeStyle="#333",a.stroke(),a.fillStyle="#000",a.font="12px sans-serif",a.fillText(`#${n.index}`,t+8,o-8),a.fillText(`${n.R.toFixed(0)} kN`,t+8,o+10)}}function X(t){Z("#pc-punch").innerHTML=`<h3>Punching Check (Preliminary)</h3><p><strong>Vu:</strong> ${t.Vu_kN.toFixed(1)} kN, <strong>\u03d5Vc:</strong> ${t.phiVc_kN.toFixed(1)} kN &nbsp; <strong>Util:</strong> ${e(t.utilisation,2)} &nbsp; <strong>Status:</strong> ${t.OK?"OK":"NG"}</p><p><em>Assumptions:</em> d = 0.8\xb7t_c, b\u2080 = \u03c0(d_p + d), \u03d5 = 0.75, V_c = 0.33\u221af'c\xb7b\u2080\xb7d (SI, N). Convert to kN.</p>`}function U(e,n){const a=t(Z("#pc-mux")),o=t(Z("#pc-muy"));Z("#pc-flexure").innerHTML=`<h3>Flexure (Singly-Reinforced, Rectangular)</h3><table class="pc-table"><thead><tr><th>Strip</th><th>\u03d5M<sub>n</sub> (kN\xb7m)</th><th>A<sub>s,req</sub> (mm\xb2)</th><th>A<sub>s,min</sub> (mm\xb2)</th><th>Status</th></tr></thead><tbody><tr><td>X</td><td>${e.phiMn_kNm.toFixed(1)}</td><td>${e.As_req_mm2.toFixed(0)}</td><td>${e.As_min_mm2.toFixed(0)}</td><td>${e.phiMn_kNm>=a?"OK":"NG"}</td></tr><tr><td>Y</td><td>${n.phiMn_kNm.toFixed(1)}</td><td>${n.As_req_mm2.toFixed(0)}</td><td>${n.As_min_mm2.toFixed(0)}</td><td>${n.phiMn_kNm>=o?"OK":"NG"}</td></tr></tbody></table>`}function O(t,n){Z("#pc-ows").innerHTML=`<h3>One-Way Shear</h3><table class="pc-table"><thead><tr><th>Strip</th><th>V<sub>u</sub> (kN)</th><th>\u03d5V<sub>c</sub> (kN)</th><th>Util</th><th>Status</th></tr></thead><tbody><tr><td>X</td><td>${t.Vu_kN.toFixed(1)}</td><td>${t.phiVc_kN.toFixed(1)}</td><td>${e(t.util,2)}</td><td>${t.OK?"OK":"NG"}</td></tr><tr><td>Y</td><td>${n.Vu_kN.toFixed(1)}</td><td>${n.phiVc_kN.toFixed(1)}</td><td>${e(n.util,2)}</td><td>${n.OK?"OK":"NG"}</td></tr></tbody></table>`}function z(t){const n=Z("#pc-mc-wrapper");if(!t.length)return void(n.hidden=!0);n.hidden=!1;const a=Z("#pc-lc-table tbody");a.innerHTML="";for(const{lc:n,sol:o,punch:i}of t){const t=o.Pmin<0?"Yes":"",s=document.createElement("tr");s.innerHTML=`<td>${n.name}</td><td>${n.P.toFixed(1)}</td><td>${n.Mx.toFixed(1)}</td><td>${n.My.toFixed(1)}</td><td>${o.Pmax.toFixed(1)}</td><td>${o.Pmin.toFixed(1)}</td><td>${e(i.utilisation,2)}</td><td>${t}</td>`,o.Pmin<0&&s.classList.add("uplift-row"),a.appendChild(s)}const o=new Map;for(const{lc:e,sol:n}of t)for(const t of n.reactions)if(o.has(t.index)){const n=o.get(t.index);t.R>n.max.val&&(n.max.val=t.R,n.max.case=e.name),t.R<n.min.val&&(n.min.val=t.R,n.min.case=e.name)}else o.set(t.index,{x:t.x,y:t.y,max:{val:t.R,case:e.name},min:{val:t.R,case:e.name}});const i=Z("#pc-pile-extremes tbody");i.innerHTML="",[...o.entries()].sort((t,e)=>t[0]-e[0]).forEach(([t,e])=>{const n=document.createElement("tr");n.innerHTML=`<td>${t}</td><td>${e.x.toFixed(3)}</td><td>${e.y.toFixed(3)}</td><td>${e.max.val.toFixed(1)}</td><td>${e.max.case}</td><td>${e.min.val.toFixed(1)}</td><td>${e.min.case}</td>`,e.min.val<0&&n.classList.add("uplift"),i.appendChild(n)})}function A(t){function n(t,e){return e.split(".").reduce((t,e)=>t&&e in t?t[e]:void 0,t)}function a(a,o){let s=-1/0,c="";for(const e of t.solutions){const t="function"==typeof o?o(e):n(e,o);"number"==typeof t&&isFinite(t)&&t>s&&(s=t,c=e.lc.name)}if(s>-1/0){const t=document.createElement("tr");t.innerHTML=`<td>${a}</td><td>${c}</td><td>${e(s,2)}</td>`,i.appendChild(t)}}if(!t)return;const o=Z("#pc-strength-cases tbody");o.innerHTML="";for(const n of t.solutions){const t=n.demands,a=document.createElement("tr");a.innerHTML=`<td>${n.lc.name}</td><td>${e(t.Mu_x,1)}</td><td>${e(t.Mu_y,1)}</td><td>${e(t.Vu_x,1)}</td><td>${e(t.Vu_y,1)}</td><td>${e(n.flexUtilX,2)}</td><td>${e(n.flexUtilY,2)}</td><td>${e(n.owsUtilX,2)}</td><td>${e(n.owsUtilY,2)}</td>`,o.appendChild(a)}const i=Z("#pc-governing tbody");i.innerHTML="",a("Flexure X","flexUtilX"),a("Flexure Y","flexUtilY"),a("One-Way Shear X","owsUtilX"),a("One-Way Shear Y","owsUtilY"),a("Punching","punch.utilisation")}function I(t){const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=document.createElement("a");n.href=URL.createObjectURL(e),n.download="pilecap_results.json",n.click()}function H(t){let e=["Case,P,Mx,My,Pmax,Pmin"];for(const n of t)e.push([n.lc.name,n.lc.P,n.lc.Mx,n.lc.My,n.sol.Pmax,n.sol.Pmin].join(","));const n=new Blob([e.join("\n")],{type:"text/csv"}),a=document.createElement("a");a.href=URL.createObjectURL(n),a.download="pilecap_cases.csv",a.click()}function q(){const t=Z(".action-row");if(!Z("#pc-iter-tension")){const e=document.createElement("fieldset");e.className="advanced",e.innerHTML='<legend>Advanced Options</legend>\n        <label class="inline"><input type="checkbox" id="pc-iter-tension"> Iterative Tension Redistribution</label>\n        <label class="inline"><input type="checkbox" id="pc-use-provided"> Use Provided Reinforcement for Capacity</label>\n        <label class="inline"><input type="checkbox" id="pc-units-toggle"> Use US Customary Units (beta)</label>\n        <div class="field-group" style="margin-top:10px;">\n          <button type="button" id="pc-export-json" class="calc-button secondary">Export JSON</button>\n          <button type="button" id="pc-export-csv" class="calc-button secondary">Export CSV</button>\n        </div>',t.parentNode.insertBefore(e,t)}}async function D(){let e;try{e=n(Z("#pc-coords").value)}catch(t){return Z("#pc-status").textContent=t.message,void Z("#pc-status").classList.add("error")}const a=t(Z("#pc-load-p")),o=t(Z("#pc-mx")),i=t(Z("#pc-my")),s=t(Z("#pc-allow-comp")),c=t(Z("#pc-allow-ten")),r=t(Z("#pc-fc")),d=t(Z("#pc-diameter")),l=t(Z("#pc-cap-thk")),p=Z("#pc-iter-tension")?.checked;let u;u=p?w({P:a,Mx:o,My:i,coords:e}):P({P:a,Mx:o,My:i,coords:e});const h=S({fcMPa:r,pileDia_m:d,capThk_m:l},u.Pmax),m=t(Z("#pc-fy")),f=t(Z("#pc-phi-flex"))||.9,x=t(Z("#pc-bx")),g=t(Z("#pc-by")),y=t(Z("#pc-deff"))||.8*l,v=t(Z("#pc-mux")),M=t(Z("#pc-muy")),b=Z("#pc-use-provided")?.checked;let F,$;if(b){const e=t(Z("#pc-bar-dia")),n=1e3/t(Z("#pc-bar-spacing"))*(Math.PI*(e/2)**2);F={phiMn_kNm:0,As_req_mm2:n*x,As_min_mm2:0},$={phiMn_kNm:0,As_req_mm2:n*g,As_min_mm2:0}}else F=N({Mu_kNm:v,b_m:x,d_m:y,fc_MPa:r,fy_MPa:m,phi:f}),$=N({Mu_kNm:M,b_m:g,d_m:y,fc_MPa:r,fy_MPa:m,phi:f});const k=t(Z("#pc-phi-shear"))||.75,_=t(Z("#pc-vux")),L=t(Z("#pc-vuy")),C=R({Vu_kN:_,b_m:x,d_m:y,fc_MPa:r,phi:k}),V=R({Vu_kN:L,b_m:g,d_m:y,fc_MPa:r,phi:k});Z("#pc-status").textContent="Single case analysis complete.",Z("#pc-status").classList.remove("error"),Z("#pc-results").hidden=!1,Y(u,s,c),W(u,s,c),T(u),X(h),U(F,$),O(C,V),Z("#pc-mc-wrapper").hidden=!0,Z("#pc-export-json").onclick=()=>I({mode:"single",sol:u,punch:h,flexure:{x:F,y:$},ows:{x:C,y:V}}),Z("#pc-export-csv").onclick=()=>{H([{lc:{name:"Single",P:a,Mx:o,My:i},sol:u}])}}async function G(){if(Z("#pc-multiple-loads").checked&&window.parsedLoadCases&&window.parsedLoadCases.length>0)await j();else{if(!Z("#pc-loadcases").value.trim())return void await D();await K()}}async function j(){const e=window.parsedLoadCases,a=t(Z("#pc-allow-comp")),o=t(Z("#pc-allow-ten")),i=t(Z("#pc-fc")),s=t(Z("#pc-diameter")),c=t(Z("#pc-cap-thk"));let r;try{r=n(Z("#pc-coords").value)}catch(t){return Z("#pc-status").textContent=t.message,void Z("#pc-status").classList.add("error")}const d=V(e.map(t=>({name:t.caseId,P:t.P,Mx:t.Mx,My:t.My})),r,a,o,i,s,c);if(!d.length)return void(Z("#pc-status").textContent="No valid load cases.");const l=_(d),p=E(d),u=d[0];Z("#pc-results").hidden=!1,Y(u.sol,a,o),W(u.sol,a,o),T(u.sol),X(u.punch),B(l),z(d,a,o),A(p),Z("#pc-status").textContent=`Multi load case analysis complete for ${e.length} cases.`,Z("#pc-status").classList.remove("error"),Z("#pc-export-json").onclick=()=>I({mode:"comprehensive-multi",solutions:d,strength:p,comprehensiveDesign:l}),Z("#pc-export-csv").onclick=()=>H(d)}async function K(){const e=Z("#pc-loadcases").value.trim(),o=t(Z("#pc-allow-comp")),i=t(Z("#pc-allow-ten")),s=t(Z("#pc-fc")),c=t(Z("#pc-diameter")),r=t(Z("#pc-cap-thk"));let d,l;try{d=n(Z("#pc-coords").value)}catch(t){return Z("#pc-status").textContent=t.message,void Z("#pc-status").classList.add("error")}try{l=a(e)}catch(t){return Z("#pc-status").textContent=t.message,void Z("#pc-status").classList.add("error")}const p=V(l,d,o,i,s,c,r);if(!p.length)return void(Z("#pc-status").textContent="No valid load cases.");const u=E(p),h=p[0];Z("#pc-results").hidden=!1,Y(h.sol,o,i),W(h.sol,o,i),T(h.sol),X(h.punch),Z("#pc-flexure").innerHTML="<p><em>Flexure auto-designed across cases: see tables above (capacities sized to governing Mu).</em></p>",Z("#pc-ows").innerHTML="<p><em>One-way shear capacities sized to governing Vu across cases.</em></p>",z(p,o,i),A(u),Z("#pc-status").textContent="Multi load case analysis complete.",Z("#pc-status").classList.remove("error"),Z("#pc-export-json").onclick=()=>I({mode:"multi",solutions:p,strength:u}),Z("#pc-export-csv").onclick=()=>H(p)}function B(t){const{results:e,weights:n,footingGeometry:a}=t;let o=`\n      <div class="comprehensive-design-results">\n        <h3>\ud83c\udfd7\ufe0f Comprehensive Footing Design Results</h3>\n        \n        <div class="design-summary">\n          <h4>Footing Properties & Weights</h4>\n          <table class="pc-table">\n            <thead>\n              <tr><th>Component</th><th>Value</th><th>Units</th></tr>\n            </thead>\n            <tbody>\n              <tr><td>Footing Dimensions</td><td>${a.footingLength}' \xd7 ${a.footingWidth}' \xd7 ${a.footingThickness}'</td><td>L \xd7 W \xd7 T</td></tr>\n              <tr><td>Footing Weight</td><td>${n.footingWeight.toFixed(1)}</td><td>kips</td></tr>\n              <tr><td>Seal Weight</td><td>${n.sealWeight.toFixed(1)}</td><td>kips</td></tr>\n              <tr><td>Soil Weight</td><td>${n.soilWeight.toFixed(1)}</td><td>kips</td></tr>\n              <tr><td>Buoyancy Force</td><td>${n.buoyancyForce.toFixed(1)}</td><td>kips</td></tr>\n              <tr><td><strong>Total Net Weight</strong></td><td><strong>${n.totalWeight.toFixed(1)}</strong></td><td><strong>kips</strong></td></tr>\n            </tbody>\n          </table>\n        </div>\n        \n        <div class="design-checks">\n          <h4>Design Check Summary</h4>\n          <table class="pc-table">\n            <thead>\n              <tr>\n                <th>Load Case</th>\n                <th>One-Way Shear X</th>\n                <th>One-Way Shear Y</th>\n                <th>Punching Shear</th>\n                <th>Status</th>\n              </tr>\n            </thead>\n            <tbody>`;e.forEach(t=>{const e=t.overallPass?"status-pass":"status-fail",n=t.overallPass?"\u2705 PASS":"\u274c FAIL";o+=`\n        <tr class="${e}">\n          <td>${t.loadCase.name||t.loadCase.caseId}</td>\n          <td>${t.oneWayShear.utilizationX.toFixed(2)} ${t.oneWayShear.passX?"\u2705":"\u274c"}</td>\n          <td>${t.oneWayShear.utilizationY.toFixed(2)} ${t.oneWayShear.passY?"\u2705":"\u274c"}</td>\n          <td>${t.punchingShear.utilization.toFixed(2)} ${t.punchingShear.pass?"\u2705":"\u274c"}</td>\n          <td><strong>${n}</strong></td>\n        </tr>`}),o+='\n            </tbody>\n          </table>\n        </div>\n        \n        <div class="detailed-checks">\n          <h4>Detailed Design Calculations</h4>';const i=e.reduce((t,e)=>{const n=Math.max(t.oneWayShear.utilizationX,t.oneWayShear.utilizationY,t.punchingShear.utilization);return Math.max(e.oneWayShear.utilizationX,e.oneWayShear.utilizationY,e.punchingShear.utilization)>n?e:t});o+=`\n          <h5>Governing Load Case: ${i.loadCase.name||i.loadCase.caseId}</h5>\n          \n          <div class="check-details">\n            <h6>One-Way Shear</h6>\n            <table class="pc-table">\n              <thead>\n                <tr><th>Direction</th><th>Vu (kips)</th><th>\u03c6Vc (kips)</th><th>Utilization</th><th>Status</th></tr>\n              </thead>\n              <tbody>\n                <tr><td>X-Direction</td><td>${i.oneWayShear.vuX.toFixed(1)}</td><td>${i.oneWayShear.phiVcX.toFixed(1)}</td><td>${i.oneWayShear.utilizationX.toFixed(2)}</td><td>${i.oneWayShear.passX?"\u2705 PASS":"\u274c FAIL"}</td></tr>\n                <tr><td>Y-Direction</td><td>${i.oneWayShear.vuY.toFixed(1)}</td><td>${i.oneWayShear.phiVcY.toFixed(1)}</td><td>${i.oneWayShear.utilizationY.toFixed(2)}</td><td>${i.oneWayShear.passY?"\u2705 PASS":"\u274c FAIL"}</td></tr>\n              </tbody>\n            </table>\n            \n            <h6>Punching Shear</h6>\n            <table class="pc-table">\n              <thead>\n                <tr><th>Parameter</th><th>Value</th><th>Units</th></tr>\n              </thead>\n              <tbody>\n                <tr><td>Total Load (Vu)</td><td>${i.punchingShear.vu.toFixed(1)}</td><td>kips</td></tr>\n                <tr><td>Critical Perimeter (bo)</td><td>${i.punchingShear.bo.toFixed(2)}</td><td>ft</td></tr>\n                <tr><td>Effective Depth (d)</td><td>${i.punchingShear.d.toFixed(2)}</td><td>ft</td></tr>\n                <tr><td>Capacity (\u03c6Vc)</td><td>${i.punchingShear.phiVc.toFixed(1)}</td><td>kips</td></tr>\n                <tr><td>Utilization</td><td>${i.punchingShear.utilization.toFixed(2)}</td><td>-</td></tr>\n                <tr><td><strong>Status</strong></td><td><strong>${i.punchingShear.pass?"\u2705 PASS":"\u274c FAIL"}</strong></td><td>-</td></tr>\n              </tbody>\n            </table>\n            \n            <h6>Flexural Reinforcement</h6>\n            <table class="pc-table">\n              <thead>\n                <tr><th>Direction</th><th>Moment (kip-ft)</th><th>Required As (in\xb2/ft)</th><th>Minimum As (in\xb2/ft)</th></tr>\n              </thead>\n              <tbody>\n                <tr><td>X-Direction</td><td>${i.flexuralMoments.muX.toFixed(1)}</td><td>${i.flexuralMoments.asReqX.toFixed(2)}</td><td>${i.flexuralMoments.asMin.toFixed(2)}</td></tr>\n                <tr><td>Y-Direction</td><td>${i.flexuralMoments.muY.toFixed(1)}</td><td>${i.flexuralMoments.asReqY.toFixed(2)}</td><td>${i.flexuralMoments.asMin.toFixed(2)}</td></tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>`;const s=Z("#pc-flexure");s?s.innerHTML=o:Z("#pc-results").insertAdjacentHTML("beforeend",o)}function J(){Z("#pc-single-load").checked=!0,Z("#pc-multiple-loads").checked=!1,Z("#single-load-section").hidden=!1,Z("#multiple-load-section").hidden=!0,Z("#pc-load-p").value=5e3,Z("#pc-mx").value=0,Z("#pc-my").value=0,Z("#pc-footing-length").value=20,Z("#pc-footing-width").value=16,Z("#pc-footing-thickness").value=3,Z("#pc-pile-no-x").value=3,Z("#pc-pile-no-y").value=2,Z("#pc-pile-spacing-x").value=8,Z("#pc-pile-spacing-y").value=8,Z("#pc-pile-size").value=14,Z("#pc-pile-capacity-compression").value=350,Z("#pc-pile-capacity-tension").value=100,Z("#pc-concrete-fc").value=4e3,Z("#pc-reinforcing-steel-fy").value=60,Z("#pc-concrete-fc-ksi").value=4,window.parsedLoadCases=null,Z("#pc-parsed-loads-display").hidden=!0,Z("#pc-multiple-load-data").value="",Z("#pc-allow-comp").value=1500,Z("#pc-allow-ten").value=0,Z("#pc-fc").value=35,Z("#pc-diameter").value=.4,Z("#pc-cap-thk").value=.9,Z("#pc-coords").value="0,0\n3,0\n3,2\n0,2",Z("#pc-loadcases").value="";const t="Load Case\tFactor\tFx (k)\tFy (k)\tFz (k)\tMx (k-ft)\tMy (k-ft)\n1\t1.00\t230\t233\t6764\t10600\t12710\n2\t1.00\t-230\t233\t4876\t10590\t10160\n3\t1.00\t0\t143\t8113\t6958\t1782\n4\t1.00\t150\t-200\t5500\t8000\t9500";Z("#pc-multiple-load-data").value=t,Z("#pc-status").textContent="Example loaded with comprehensive design parameters.",Z("#pc-status").classList.remove("error"),Z("#pc-status").classList.add("success")}let Q="SI";const Z=t=>document.querySelector(t);document.addEventListener("DOMContentLoaded",()=>{d(),q(),Z("#pc-analyze").addEventListener("click",()=>{G()}),Z("#pc-example").addEventListener("click",J),Z("#pc-reset").addEventListener("click",()=>{Z("#pc-results").hidden=!0,Z("#pc-status").textContent="",Z("#pc-status").classList.remove("error"),Z("#pc-mc-wrapper").hidden=!0}),Z("#pc-units-toggle")?.addEventListener("change",t=>{Q=t.target.checked?"US":"SI",Z("#pc-status").textContent="Unit system: "+Q,Z("#pc-status").classList.remove("error")})})}();</script> <script src="/assets/js/pilecap-ui-test.js"></script> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> ¬© Copyright 2025 Sandesh Lamsal. Last updated: September 07, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?5d75c11f89cd96294bf5e6dd1ee1bb30"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>